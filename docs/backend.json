{
  "entities": {
    "User": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "User",
      "type": "object",
      "description": "Represents a user in the VPAC Client Care application.",
      "properties": {
        "id": { "type": "string", "description": "Unique identifier for the User entity." },
        "email": { "type": "string", "description": "Email address of the user.", "format": "email" },
        "firstName": { "type": "string", "description": "First name of the user." },
        "lastName": { "type": "string", "description": "Last name of the user." },
        "role": { "type": "string", "description": "Role of the user, determining their permissions.", "enum": ["staff", "client", "office_assistant"] }
      },
      "required": ["id", "email", "firstName", "lastName", "role"]
    },
    "Appointment": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Appointment",
      "type": "object",
      "description": "Represents a scheduled appointment.",
      "properties": {
        "id": { "type": "string", "description": "Unique identifier for the Appointment entity." },
        "staffId": { "type": "string", "description": "Reference to User (Staff). May be null for pending urgent appointments." },
        "clientId": { "type": "string", "description": "Reference to User (Client). May be null for anonymous bookings." },
        "clientName": { "type": "string", "description": "Client name (for urgent requests or anonymous bookings)." },
        "clientEmail": { "type": "string", "description": "Client email (for urgent requests or anonymous bookings).", "format": "email" },
        "clientPhone": { "type": "string", "description": "Client phone number (for urgent requests)." },
        "startTime": { "type": "string", "description": "Start time of the appointment.", "format": "date-time" },
        "endTime": { "type": "string", "description": "End time of the appointment.", "format": "date-time" },
        "meetingLink": { "type": "string", "description": "Link to the online meeting.", "format": "uri" },
        "status": { 
          "type": "string", 
          "description": "Status of the appointment.", 
          "enum": ["pending", "scheduled", "confirmed", "cancelled", "completed"],
          "default": "scheduled"
        },
        "isUrgent": { "type": "boolean", "description": "Whether this is an urgent appointment request." },
        "reason": { "type": "string", "description": "Reason for urgent appointment (required for urgent requests)." },
        "requestedAt": { "type": "string", "description": "Timestamp when urgent request was created.", "format": "date-time" },
        "assignedAt": { "type": "string", "description": "Timestamp when urgent appointment was assigned.", "format": "date-time" },
        "assignedBy": { "type": "string", "description": "User ID of staff member who assigned the urgent appointment." }
      },
      "required": ["id", "status"]
    },
    "AppointmentDetail": {
        "title": "AppointmentDetail",
        "type": "object",
        "description": "Stores additional details for an appointment.",
        "properties": {
            "id": { "type": "string", "description": "Unique identifier for the detail record."},
            "appointmentId": { "type": "string", "description": "Reference to the Appointment."},
            "reason": { "type": "string", "description": "Reason for the appointment."},
            "notes": { "type": "string", "description": "Notes taken during the appointment."}
        },
        "required": ["id", "appointmentId"]
    },
    "CarePlanTask": {
        "title": "CarePlanTask",
        "type": "object",
        "description": "A single task in a client's care plan.",
        "properties": {
            "id": { "type": "string", "description": "Unique identifier for the task."},
            "clientId": { "type": "string", "description": "The client this task is for."},
            "staffId": { "type": "string", "description": "The staff member who assigned the task."},
            "task": { "type": "string", "description": "The description of the task."},
            "status": { "type": "string", "enum": ["Pending", "Complete"]},
            "date": { "type": "string", "format": "date"}
        },
        "required": ["id", "clientId", "staffId", "task", "status", "date"]
    },
    "MedicalRecord": {
        "title": "MedicalRecord",
        "type": "object",
        "description": "Represents a medical record for a client.",
        "properties": {
            "id": { "type": "string", "description": "Unique identifier for the record."},
            "clientId": { "type": "string", "description": "The client this record belongs to."},
            "staffId": { "type": "string", "description": "The staff member who uploaded the record."},
            "type": { "type": "string", "description": "The type of record (e.g., Lab Results, Medications)."},
            "fileUrl": { "type": "string", "description": "A URL to the record file.", "format": "uri"},
            "uploadDate": { "type": "string", "format": "date-time"}
        },
        "required": ["id", "clientId", "staffId", "type", "uploadDate"]
    },
    "DocumentTemplate": {
        "title": "DocumentTemplate",
        "type": "object",
        "description": "A template for a document like a registration or privacy form.",
        "properties": {
            "id": { "type": "string" },
            "title": { "type": "string"},
            "fileUrl": { "type": "string", "format": "uri"}
        },
        "required": ["id", "title"]
    },
    "ClientDocument": {
        "title": "ClientDocument",
        "type": "object",
        "description": "Represents a document submitted by a client.",
        "properties": {
            "id": { "type": "string"},
            "clientId": { "type": "string"},
            "templateId": { "type": "string"},
            "fileUrl": { "type": "string", "format": "uri"},
            "uploadDate": { "type": "string", "format": "date-time"}
        },
        "required": ["id", "clientId", "templateId", "uploadDate"]
    },
    "AvailabilityBlock": {
      "title": "AvailabilityBlock",
      "type": "object",
      "description": "Represents a block of time when a staff member is available.",
      "properties": {
        "id": { "type": "string" },
        "staffId": { "type": "string" },
        "startTime": { "type": "string", "format": "date-time" },
        "endTime": { "type": "string", "format": "date-time" }
      },
      "required": ["id", "staffId", "startTime", "endTime"]
    },
    "Integration": {
      "title": "Integration",
      "type": "object",
      "description": "Represents an integration with a third-party service.",
      "properties": {
        "id": { "type": "string" },
        "userId": { "type": "string" },
        "service": { "type": "string", "enum": ["google-meet", "microsoft-teams", "quo", "google-sheets", "appsheet"] },
        "accessToken": { "type": "string" }, "refreshToken": { "type": "string" },
        "spreadsheetId": { "type": "string" }, "appUrl": { "type": "string" }
      },
      "required": ["id", "userId", "service"]
    }
  },
  "auth": {
    "providers": ["password", "google.com", "apple.com"]
  },
  "firestore": {
    "structure": [
      {
        "path": "/users/{userId}",
        "definition": { "entityName": "User", "schema": { "$ref": "#/backend/entities/User" }, "description": "Stores user profiles." }
      },
      {
        "path": "/users/{userId}/availability_blocks/{availabilityBlockId}",
        "definition": { "entityName": "AvailabilityBlock", "schema": { "$ref": "#/backend/entities/AvailabilityBlock" }, "description": "Stores availability for staff." }
      },
      {
        "path": "/users/{userId}/integrations/{integrationId}",
        "definition": { "entityName": "Integration", "schema": { "$ref": "#/backend/entities/Integration" }, "description": "Stores user-specific integration secrets." }
      },
      {
          "path": "/users/{userId}/care_plan_tasks/{taskId}",
          "definition": { "entityName": "CarePlanTask", "schema": { "$ref": "#/backend/entities/CarePlanTask"}, "description": "Tasks for a client's care plan."}
      },
      {
          "path": "/users/{userId}/records/{recordId}",
          "definition": { "entityName": "MedicalRecord", "schema": { "$ref": "#/backend/entities/MedicalRecord"}, "description": "Medical records for a client."}
      },
      {
          "path": "/users/{userId}/documents/{documentId}",
          "definition": { "entityName": "ClientDocument", "schema": { "$ref": "#/backend/entities/ClientDocument"}, "description": "Documents submitted by a client."}
      },
      {
        "path": "/appointments/{appointmentId}",
        "definition": { "entityName": "Appointment", "schema": { "$ref": "#/backend/entities/Appointment" }, "description": "Stores appointment details." }
      },
      {
          "path": "/appointments/{appointmentId}/details/{detailId}",
          "definition": { "entityName": "AppointmentDetail", "schema": { "$ref": "#/backend/entities/AppointmentDetail"}, "description": "Additional details for an appointment."}
      },
      {
          "path": "/document_templates/{templateId}",
          "definition": { "entityName": "DocumentTemplate", "schema": { "$ref": "#/backend/entities/DocumentTemplate"}, "description": "Master templates for documents."}
      }
    ]
  }
}
